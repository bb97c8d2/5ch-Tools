Donguri Bag Enhancer v4.6.2

## 作者

どんぐりID: bb97c8d2

## 概要

このスクリプトは、5ちゃんねるが提供する「どんぐりシステム」に含まれるゲーム要素に適用するもので、「アイテムバッグ」ページを機能拡張し、フィルタリング、ソート、スクロール追従、分解アラートなどのな支援機能を追加します。
仕様の設計・提案は「どんぐりID: bb97c8d2」によって行われ、コーディング作業はChatGPT（OpenAI）によって行われました。  

## ライセンス

- 非商用・個人利用に限り自由に使用・改変・再配布が可能です。
- 商用利用、再販売、営利目的での利用は禁止します。
- 利用により生じた損害について、作者は一切の責任を負いません。

## 機能一覧

- ページ全体のレイアウトを調整して余白を減らしています。
- テーブル（表）の行数をカウントすることによって、アイテム数を算出して表示します。
- 各テーブルに見出しを挿入します。（「━━ ネックレス ━━」等）
- 「解」列のヘッダーをクリックすると、施錠（ロック）の有無でソートされます。
- [錠]／[解錠]切替や[分解]の処理中はオーバーレイを表示します。オーバーレイは自動で消えますが、クリックして強制的に消すこともできます。
- [錠]／[解錠]切替や[分解]をする時、該当テーブルの再描画で対応し、ページの再読み込みを回避します。
- 施錠（ロック）されていないアイテムは目に付きやすいように、同じ行の一部セルを背景オレンジ／文字白で表示します。
- ネックレステーブル専用機能
    「増減」列を追加し、BuffとDebuffによる補正値を単純計算して、正なら△、負なら▼で表示します。
    「増減」列はヘッダーをクリックすると昇順／降順ソートされます。
    テーブル上にフィルタUIを設置しました。
      - プロパティ（攻撃の嵐,元素の混沌,破滅の打撃…）による絞り込みができます。
      - 「全解除」でチェックボックスの一括OFFができます。
      - チェックボックスの動作が不安定になったら、ボタン「再読込」でリセットを試みることができます。
- 武器／防具テーブル専用機能
    テーブル上にフィルタUIを設置しました。
      - レアリティ（UR, SSR, SR, R, N）及びエレメント（火・氷・雷…なし）による絞り込みやソートができます。
      - ボタン「全選択」「全解除」でチェックボックスの一括ON/OFFができます。
      - チェックボックスの動作が不安定になったら、ボタン「再読込」でリセットを試みることができます。
    「名称／レアリティ」列、「ELEM」列のヘッダーをクリックすると、「レアリティ ＞ ELEM ＞ マリモ」の順で多段ソートされます。
    「名称／レアリティ」列、「ELEM」列のセルをクリックすると、同じレアリティ／ELEMの装備が抽出されます。（クリックしたセルを追従します）
- サブウインドウ専用機能
    画面左下に固定の「☰」ボタンを設置し、これをクリックするとサブウインドウが開閉します。
    チェックボックスのON/OFFで、ネックレステーブルの「増減」列について、表示/非表示を切り替えられます。
    チェックボックスのON/OFFで、ネックレス／武器／防具テーブルの「分解」列について、一括して表示/非表示を切り替えられます。
    チェックボックスのON/OFFで、ページ内の「ロックされていないアイテムを全て分解する」ボタンについて、表示/非表示を切り替えられます。
      - なお、サブウインドウ内のボタンは含みません。
   「「全て分解」まきこみアラート」によって、誤って装備を分解してしまうリスクを低減します。
      - 「ロックされていないアイテムを全て分解する」を実行時に、指定したグレード／レアリティの装備が分解対象に含まれていたら警告を表示します。
      - 警告ウインドウで「分解する」を選ぶとそのまま分解が実行され、「キャンセル」を選ぶと分解がキャンセルされます。
      - ただし、誤分解を100％回避できると保証するものではありませんので、過信しないでください。
   「ロックされていないアイテムを全て分解する」ボタンを設置しました。ページ内の同ボタンと同じ機能です。
      - ページをスクロールさせることなく、サブウインドウから同ボタンの機能を利用できます。
    ナビゲーションボタン（PageTOP, ネックレス, 武器, 防具）を設置しました。

## 注意事項

- 本スクリプトは個人開発物であり、どんぐりシステム公式とは関係ありません。
- バグや仕様変更により正常に動作しない場合があります。ご了承ください。
- 質問やバグ報告は必ず非公式サポートの範囲内でお願いします。

## インストール方法

1. 「Tampermonkey」などのユーザースクリプト管理拡張をブラウザにインストールします。
2. スクリプトファイル「Donguri_Bag_Enhancer_v4.6.2.user.js」をTampermonkeyに読み込ませます。
3. **https://donguri.5ch.net/bag** にアクセスすると、自動的にスクリプトが適用されます。

## 履歴

v4.6.2
〈新規〉「Donguri Bag Operator v3.1.2」を統合し、ひとつのファイルにしました。
〈新規〉「解」列のヘッダーをクリックすると、施錠（ロック）の有無でソートされるようにしました。
〈新規〉サブウインドウを実装しました。
〈新規〉サブウインドウに「「全て分解」まきこみアラート」を実装しました。
〈新規〉サブウインドウに「増減」列、「分解」列、「全て分解」ボタンの表示／非表示を切り替える機能を実装しました。
〈新規〉サブウインドウに「全て分解」ボタンを実装しました。
〈修正〉クリックしたセルが画面中央に来るように自動でスクロールする機能が想定外の動作をしていた不具合を修正しました。
〈修正〉[分解]を行った時に対象の行が削除されない不具合を修正しました。

v2.1.3
〈新規〉README.txtを添付しました。
